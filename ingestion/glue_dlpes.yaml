source:
  type: glue
  config:
    aws_region: "eu-west-1"
    database_pattern:
      allow: ["dlpes_dwp_hmrc_main_datashare$", "dlpes_hmrc_mini_datashare$"]
    extract_owners: False
    extract_transforms: False

transformers:
  - type: "ingestion.transformers.enrich_container.AddOwnershipTransformer"
    config:
      data_custodian: "${DLPES_DWP_HMRC_DATASHARE_CONTACT}"

  - type: "ingestion.transformers.enrich_container.AddTagTransformer"
    config:
      tag_urns:
        - "urn:li:tag:dc_display_in_catalogue"
        - "urn:li:tag:Prison"
        - "urn:li:tag:Probation"
        - "urn:li:tag:Prisons and probation"
        - "urn:li:tag:Employment and benefits"
        - "urn:li:tag:Police national computer"

  - type: "ingestion.transformers.enrich_container.AddPropertiesTransformer"
    config:
      description: >-
        The overarching aim of this share is to improve our
        understanding of the potential links between offending, employment and
        benefits.

        The share includes anyone who appears on the Police National Computer with
        at least one caution or conviction for a recordable offence in England and
        Wales since 2000 and who can be successfully matched onto DWP/HMRC records.

        This data is matched onto DWP benefit records and HMRC employment records
        held on RAPID from 2008. The share is updated every two to three years.
        To enquire about access, please email datalinkingteam@justice.gov.uk
        """
      properties:
        dc_readable_name: "calculate_release_dates"
        dc_slack_channel_name: "#calculate_release_dates_public_channel"
        dc_slack_channel_url: https://moj.enterprise.slack.com/archives/C02BD7MFE7K
        dc_where_to_access_dataset: Please contact the team
        dc_access_requirements: ""
        refresh_period: Every day
        security_classification: Official-Sensitive

  - type: "simple_add_dataset_tags"
    config:
      tag_urns:
        - "urn:li:tag:dc_display_in_catalogue"
        - "urn:li:tag:Prison"
        - "urn:li:tag:Probation"
        - "urn:li:tag:Prisons and probation"
        - "urn:li:tag:Employment and benefits"
        - "urn:li:tag:Police national computer"

  - type: "simple_add_dataset_ownership"
    config:
      semantics: OVERWRITE
      ownership_type: "DATAOWNER"
      owner_urns:
        - "${DLPES_DWP_HMRC_DATASHARE_CONTACT}"

  - type: "simple_add_dataset_properties"
    config:
      semantics: OVERWRITE # OVERWRITE is default behaviour
      properties:
        dc_slack_channel_name: "#data-linking-databases"
        dc_slack_channel_url: https://moj.enterprise.slack.com/archives/C01VDDG5V5W
        dc_where_to_access_dataset: AnalyticalPlatform
        dc_access_requirements: https://user-guidance.analytical-platform.service.justice.gov.uk/tools/create-a-derived-table/database-access/#database-access
        refresh_period: Every 3 years
        security_classification: Official-Sensitive
