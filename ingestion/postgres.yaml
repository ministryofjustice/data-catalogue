pipeline_name: "${INGESTION_NAME}"
source:
  type: postgres
  config:
    # Coordinates
    host_port: "${HOST_PORT}"
    database: "${DATABASE}"

    # Credentials
    username: "${USER}"
    password: "${PASSWORD}"

    # Optional: SSL configuration.
    # options:
    #   connect_args:
    #     sslcert: "<<path to sslcert>>"
    #     sslkey: "<<path to sslkey>>"
    #     sslrootcert: "<<path to verification ca chain>>"
    #     sslmode: "verify-full"

transformers:
  - type: "simple_add_dataset_tags"
    config:
      tag_urns:
        - "urn:li:tag:dc_display_in_catalogue"
        - "urn:li:tag:Prisons and probation"
  - type: "ingestion.transformers.enrich_container_transformer.EnrichContainerTransformer"
    config:
      data_custodian: "${PLACEHOLDER_TECHNICAL_CONTACT}"
      subject_areas:
        - Prisons and probation
      properties:
        dc_slack_channel_name: "#ask-data-linking"
        dc_slack_channel_url: https://moj.enterprise.slack.com/archives/CR21T7GTA
        dc_where_to_access_dataset: AnalyticalPlatform
        dc_access_requirements: https://user-guidance.analytical-platform.service.justice.gov.uk/tools/create-a-derived-table/database-access/#database-access
        refresh_period: Daily
        security_classification: Official-Sensitive
  - type: "simple_add_dataset_properties"
    config:
      semantics: OVERWRITE # OVERWRITE is default behaviour
      properties:
        dc_slack_channel_name: "#ask-data-linking"
        dc_slack_channel_url: https://moj.enterprise.slack.com/archives/CR21T7GTA
        dc_where_to_access_dataset: AnalyticalPlatform
        dc_access_requirements: https://user-guidance.analytical-platform.service.justice.gov.uk/tools/create-a-derived-table/database-access/#database-access
        refresh_period: Daily
        security_classification: Official-Sensitive
